<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content=Leslie><link href=https://leslieclif.github.io/notebook/devops/gitops/ rel=canonical><link rel="shortcut icon" href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.1.2, mkdocs-material-7.0.3"><title>GitOps - Leslie's Online Notebook</title><link rel=stylesheet href=../../assets/stylesheets/main.1655a90d.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.7fa14f5b.min.css><script src=../../assets/extra.js type=text/javascript></script><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/extra.css></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=deep-blue data-md-color-accent=yellow> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#introduction class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=https://leslieclif.github.io/notebook/ title="Leslie's Online Notebook" class="md-header__button md-logo" aria-label="Leslie's Online Notebook"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 2l-5 4.5v11l5-4.5V2M6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Leslie's Online Notebook </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> GitOps </span> </div> </div> </div> <div class=md-header__options> <div class="md-header-nav__scheme md-header-nav__button md-source__icon md-icon"> <a href=javascript:toggleScheme(); title="Dark mode" class=dark-mode> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1z"/></svg> </a> <a href=javascript:toggleScheme(); title="Light mode" class=light-mode> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5z"/></svg> </a> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://leslieclif.github.io/notebook/ title="Leslie's Online Notebook" class="md-nav__button md-logo" aria-label="Leslie's Online Notebook"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 2l-5 4.5v11l5-4.5V2M6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5z"/></svg> </a> Leslie's Online Notebook </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1> Home <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Home data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Installation </a> </li> <li class=md-nav__item> <a href=../../developer/ class=md-nav__link> Developer Setup </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2> Devops <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Devops data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Devops </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../ci/ class=md-nav__link> CI </a> </li> <li class=md-nav__item> <a href=../cd/ class=md-nav__link> CD </a> </li> <li class=md-nav__item> <a href=../iac/ class=md-nav__link> IAC </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> GitOps <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> GitOps </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#introduction class=md-nav__link> Introduction </a> <nav class=md-nav aria-label=Introduction> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-is-gitops class=md-nav__link> What is GitOps? </a> </li> <li class=md-nav__item> <a href=#gitops-principles class=md-nav__link> Gitops Principles </a> </li> <li class=md-nav__item> <a href=#gitops-vs-devops class=md-nav__link> GitOps vs. DevOps </a> </li> <li class=md-nav__item> <a href=#gitops-and-kubernetes class=md-nav__link> GitOps and Kubernetes </a> </li> <li class=md-nav__item> <a href=#traditional-vs-gitops class=md-nav__link> Traditional vs GitOps </a> </li> <li class=md-nav__item> <a href=#gitops-usecases class=md-nav__link> Gitops Usecases </a> </li> <li class=md-nav__item> <a href=#the-gitops-workflow class=md-nav__link> The GitOps Workflow </a> </li> <li class=md-nav__item> <a href=#gitops-tools class=md-nav__link> GitOps Tools </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../devops-engineer/ class=md-nav__link> Skills </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> IDE <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=IDE data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> IDE </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ide/ class=md-nav__link> IDE Tips and Tricks </a> </li> <li class=md-nav__item> <a href=../../ide/markdown/ class=md-nav__link> Markdown </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> Server <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Server data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Server </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../server/ class=md-nav__link> Server Details </a> </li> <li class=md-nav__item> <a href=../../server/install/ class=md-nav__link> Installation </a> </li> <li class=md-nav__item> <a href=../../server/mobile/ class=md-nav__link> Mobile </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5> Ansible <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Ansible data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Ansible </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../learning/ansible/ansible/ class=md-nav__link> Ansible </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6 type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6> Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Kubernetes data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../k8s/ class=md-nav__link> Kubernetes </a> </li> <li class=md-nav__item> <a href=../../k8s/install/ class=md-nav__link> Installation </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_7 type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7> Learning <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Learning data-md-level=1> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Learning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../learning/git/ class=md-nav__link> Git </a> </li> <li class=md-nav__item> <a href=../../learning/python/ class=md-nav__link> Python </a> </li> <li class=md-nav__item> <a href=../../learning/vagrant/ class=md-nav__link> Vagrant </a> </li> <li class=md-nav__item> <a href=../../learning/terraform/ class=md-nav__link> Terraform </a> </li> <li class=md-nav__item> <a href=../../learning/docker/docker-notes/ class=md-nav__link> Docker </a> </li> <li class=md-nav__item> <a href=../../learning/k8s/k8s-notes/ class=md-nav__link> Kubernetes </a> </li> <li class=md-nav__item> <a href=../../learning/linux/linux/ class=md-nav__link> Linux </a> </li> <li class=md-nav__item> <a href=../../learning/linux/security/ class=md-nav__link> Linux_Security </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#introduction class=md-nav__link> Introduction </a> <nav class=md-nav aria-label=Introduction> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-is-gitops class=md-nav__link> What is GitOps? </a> </li> <li class=md-nav__item> <a href=#gitops-principles class=md-nav__link> Gitops Principles </a> </li> <li class=md-nav__item> <a href=#gitops-vs-devops class=md-nav__link> GitOps vs. DevOps </a> </li> <li class=md-nav__item> <a href=#gitops-and-kubernetes class=md-nav__link> GitOps and Kubernetes </a> </li> <li class=md-nav__item> <a href=#traditional-vs-gitops class=md-nav__link> Traditional vs GitOps </a> </li> <li class=md-nav__item> <a href=#gitops-usecases class=md-nav__link> Gitops Usecases </a> </li> <li class=md-nav__item> <a href=#the-gitops-workflow class=md-nav__link> The GitOps Workflow </a> </li> <li class=md-nav__item> <a href=#gitops-tools class=md-nav__link> GitOps Tools </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>GitOps</h1> <h2 id=introduction>Introduction<a class=headerlink href=#introduction title="Permanent link">&para;</a></h2> <ul> <li>GitOps is the <strong>next phase</strong> of infrastructure management. </li> <li>In conjunction with DevOps and Kubernetes, your business can achieve a higher lever of stability, efficiency, and reliability in the software development lifecycle. </li> <li>GitOps ensures that the <strong>software and deployment lifecycle is more predictable and repeatable</strong>, which makes your business more profitable.</li> </ul> <h3 id=what-is-gitops>What is GitOps?<a class=headerlink href=#what-is-gitops title="Permanent link">&para;</a></h3> <blockquote> <p><code>Operations</code> that are driven thorugh Git is called <strong>GitOps</strong>. - GitOps is a paradigm that empowers developers to undertake tasks that might otherwise be handled by operations. - <code>Operations</code> are the processes and services that are overseen by a company’s IT department. - This may include technology and infrastructure management (including software), quality assurance, network administration, and device management. - Traditionally, developers don’t function under the operations umbrella. - This can place development and operations in their own silos. - <strong>GitOps</strong> aims to remove those silos, and enable operations to employ the same tools and methodologies that developers use for efficient collaboration. - GitOps, as its name implies, relies on Git as the only source of truth; even for code related to IT operations. - GitOps is possible due to <code>Infrastructure as Code (IaC)</code> tools that allow you to create and manage your infrastructure using declarative configuration files. <img alt=GitOps-Examples src=../../assets/images/gitops-examples.png> The three basic components of GitOps are the following:</p> <blockquote> <ol> <li><strong>Infrastructure as Code (IaC)</strong>, a methodology that stores all infrastructure configuration as code.</li> <li><strong>Merge Requests (MRs)</strong> to serve as a change mechanism for infrastructure updates.</li> <li><strong>Continuous Integration/Continuous Delivery (CI/CD)</strong> that automates building, testing, and deploying applications, and services.</li> </ol> </blockquote> </blockquote> <h3 id=gitops-principles>Gitops Principles<a class=headerlink href=#gitops-principles title="Permanent link">&para;</a></h3> <p><img alt=GitOps-Summary src=../../assets/images/gitops-principles-summary.png> <img alt=GitOps-Principles src=../../assets/images/gitops-principles.png> 1. Describe the state of the system declaratively. <img alt=GitOps-Principles-1 src=../../assets/images/gitops-principle-1.png> 2. Store the system's desired state in git. <img alt=GitOps-Principles-2 src=../../assets/images/gitops-principle-2.png> 3. Change the system desired state using git commit and automation. No manual changes are present in Gitops. <img alt=GitOps-Principles-3 src=../../assets/images/gitops-principle-3.png> 4. An Operator within the system ensures an drift is automatically corrected. <img alt=GitOps-Principles-4 src=../../assets/images/gitops-principle-4.png></p> <h3 id=gitops-vs-devops>GitOps vs. DevOps<a class=headerlink href=#gitops-vs-devops title="Permanent link">&para;</a></h3> <ul> <li>GitOps borrows best practices from DevOps and applies them to infrastructure automation. </li> <li>This includes version control, collaboration, compliance, and CI/CD. </li> <li>Tools like Kubernetes have helped automate the software development lifecycle. Because so many businesses use container deployment to scale applications and services, they often depend upon third-party, cloud-based services to host their infrastructure. This has led to the rise of infrastructure automation to achieve a level of elasticity not possible with traditional infrastructure.</li> <li> <p><code>DevOps</code> assists in the automation of the software development lifecycle, while <code>GitOps</code> contributes to the automation of infrastructure. </p> </li> <li> <p>There are a few key differences between GitOps and DevOps. </p> </li> <li>First, GitOps uses Git to manage infrastructure provisioning and software deployment. DevOps, on the other hand, focuses primarily on CI/CD and does not focus on any one tool. </li> <li>The primary focus of GitOps is to ensure that DevOps is done correctly, whereas DevOps focuses less on correctness. </li> <li>GitOps is also less flexible than DevOps. It is also much easier to adopt GitOps in a business that already employs DevOps.</li> </ul> <h3 id=gitops-and-kubernetes>GitOps and Kubernetes<a class=headerlink href=#gitops-and-kubernetes title="Permanent link">&para;</a></h3> <ul> <li>GitOps focuses on automating infrastructure, so it’s a perfect workflow for businesses that employ Kubernetes. </li> </ul> <blockquote> <p>When you employ GitOps and Kubernetes:</p> <blockquote> <ol> <li>GitOps ensures everything operates as it was intended.</li> <li>Kubernetes ensures stability and availability.</li> </ol> </blockquote> </blockquote> <ul> <li>Kubernetes always makes sure a deployed application or service remains in a <strong>stable state and scales as needed</strong>.</li> <li>When GitOps is along for the ride, it ensures everything runs as it should, including the infrastructure necessary for the deployments. </li> <li>GitOps serves as the glue between application build/delivery (Kubernetes) and where the application is to run.</li> </ul> <h3 id=traditional-vs-gitops>Traditional vs GitOps<a class=headerlink href=#traditional-vs-gitops title="Permanent link">&para;</a></h3> <ul> <li>Common pattern used by organizations is the <strong>CIOps</strong>. <blockquote> <ol> <li>In this pattern, a change is made to the application in the source repository. This triggers the build system.</li> <li>The CI pipeline builds the software and executes tests against it and packages it into a container image and is stored in a container registry.</li> <li>CI pipeline then triggeres the CD pipeline which has permission to make calls against the K8s API. This the point where the security concern is raised.</li> <li>Once the cluster state is updated in ETCD, the cluster begins to materialize the desired state by pulling the built image from the container registry and deploying it against the nodes.</li> </ol> </blockquote> </li> <li>If the application change is not correct, it is difficult to recover from a bad deployment as the state is updated and the cluster has become unstable.</li> </ul> <blockquote> <p>Disadvantages of CIOps</p> <blockquote> <ol> <li>There is little separation between CI and CD system as it could be the same tool. Its like forcing the CI tool to do continuous delivery which it was not supposed to do.</li> <li>CI tool needs priviledges to make K8s API calls to perform deployments. It violates the trust boundary and can allow an attacker to use a compromised pipeline to execute a malicious code.</li> <li>Its not stable as success or failure of deployments is unknown. This is true in case a deployment fails and leaves the cluster in an unstable state.</li> <li>Not a feasible option for multiple clusters or a single large cluster.</li> </ol> </blockquote> </blockquote> <ul> <li>Gitops pattern <img alt=GitOps-Pattern src=../../assets/images/gitops-pattern.png><blockquote> <p>First store the desired state declaratively in git. Pull the desired state into the system using an operator. Use a control loop to keep all of this in sync. </p> </blockquote> </li> </ul> <blockquote> <ol> <li>It keeps the CI pipeline intact from CIOps except for removing the trigger for the CD pipeline.</li> <li>Under Gitops, the sole responsiblity of CI is to produce an artifact, in this case its a container image that is placed within an artifact repository.</li> <li>The Operator takes over from CI. It monitors the desired state in git for any changes which are made to a separate <code>Environment</code> repo which are made using <code>pull requests</code>.</li> <li>Once operator detects a change to the K8s manifest in the repo and provides this to the K8s control plane using the API to update the new state of the cluster.</li> <li>This causes the cluster to pull the new image and deploys it across the nodes. </li> </ol> </blockquote> <h3 id=gitops-usecases>Gitops Usecases<a class=headerlink href=#gitops-usecases title="Permanent link">&para;</a></h3> <p><img alt=GitOps-Usecases src=../../assets/images/gitops-usecases.png> 1. <strong>Infrastructure Operations</strong>: Gitops expects resources can be rapidly deployed using Cloud services. Teams use tools like Trraform to declare the infrastructure in manifest to create K8s cluster in a particular region. 2. <strong>Application Operations</strong>: Flux is used to ensure applications are deployed in an automated fashion to a K8s cluster 3. <strong>Release Operations</strong>: GitOps practises can be applied to declaratively define complex release strategies like Canary or Blue green deployments. Tools like Flagger fall into this space. </p> <h3 id=the-gitops-workflow>The GitOps Workflow<a class=headerlink href=#the-gitops-workflow title="Permanent link">&para;</a></h3> <ul> <li>The traditional application lifecycle resembles the following: <div class=highlight><pre><span></span><code>Design --&gt; Build --&gt; Image --&gt; Test --&gt; Deploy
</code></pre></div></li> <li>When you add GitOps into the mix, that lifecycle looks as follows: <div class=highlight><pre><span></span><code>Design --&gt; Build --&gt; Image --&gt; Test --&gt; Monitor --&gt; Log changes/events --&gt; Alert when a change has occurred --&gt; Update
</code></pre></div> <img alt=GitOps-Workflow src=../../assets/images/gitops-workflow.png></li> <li>With a <strong>Kubernetes workflow</strong> as your source of truth all necessary code is stored in a Git repository with the help of automation. </li> <li>Anyone with Kubernetes management rights can create pull requests, edit code, and issue merge requests to the repository. </li> <li>Once a merge request is complete, the automated GitOps operator detects the changes, another automator declares if the change is operational, and the change is automatically deployed to the cluster.</li> <li>Within the GitOps workflow you not only have a high level of automation, but there’s also a much higher probability that every deployment works exactly as expected.</li> <li>Using Flux as the gitops operator within Kubernetes. <img alt=GitOps-Flux src=../../assets/images/flux.png></li> <li>Using Flux and Flagger together to bring in Progressive or Blue-Green Deployment strategies. <img alt=GitOps-Flagger src=../../assets/images/flagger.png></li> </ul> <p><img alt=GitOps-Example src=../../assets/images/gitops-argo-cd.png></p> <ul> <li>An alternate workflow created by Gitlab <img alt=GitOps-Gitlab-Workflow src=../../assets/images/gitops-gitlab-workflow.png></li> </ul> <blockquote> <p>Advantages of GitOps</p> <blockquote> <ol> <li>CI and CD are decoupled into separate concerns.</li> <li>CI pipeline is left intact. However the CD pipeline is shifted inside the cluster where an <strong>Operator</strong> is responsible for automating deployment of changes to ensure it matches the desired state found in git.</li> <li>This eliminates the potential security concerns associated with the traditional push model from CIOps.</li> <li>It also provides recoverabilty as the cluster can be quickly rebuilt from source code.</li> </ol> </blockquote> </blockquote> <h3 id=gitops-tools>GitOps Tools<a class=headerlink href=#gitops-tools title="Permanent link">&para;</a></h3> <p><img alt=GitOps-Tools src=../../assets/images/gitops-tools.png> There are several tools useful to GitOps, some of those tools include:</p> <ol> <li><strong>Git</strong> - a version control system.</li> <li><strong>GitHub</strong> - a code repository for housing your code.</li> <li><strong>Cloud Build</strong> - a service that executes the build step of your deployment lifecycle using pre-packaged docker containers that include all of the appropriate tooling.</li> <li><strong>CircleCI</strong> - a SaaS-style build engine that simplifies the build steps and can serve as a CI/CD engine.</li> <li><strong>Kubernetes</strong> - a container orchestration platform that can be seamlessly integrated with GitOps.</li> <li><strong>Helm</strong> - a robust tool for configuring Kubernetes resources.</li> <li><strong>Flux</strong> - the GitOps operator for Kubernetes which automatically adjusts the Kubernetes cluster configuration based on the configurations found in your Git repo.</li> <li><strong>Flagger</strong> - automates the detection of errors in code and prevents those errors from being deployed.</li> <li><strong>Prometheus</strong> - a powerful GitOps monitoring tool that can generate alerts that are detected by Flagger.</li> <li><strong>Quay</strong> - an application registry and container image manager.</li> </ol> </article> </div> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../iac/ class="md-footer__link md-footer__link--prev" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> IAC </div> </div> </a> <a href=../devops-engineer/ class="md-footer__link md-footer__link--next" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Skills </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2022 - Leslie </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> with emoji by <a href=https://github.com/twitter/twemoji target=_blank rel=noopener> Twemoji </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script> <script src=../../assets/javascripts/bundle.ca5457b8.min.js></script> </body> </html>